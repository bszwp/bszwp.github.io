---
layout: post
title: "更改yum安装源以加快速度"
date: 2017-05-08
tags: Linux
---

### 一、更改yum源为网易源

> vi /etc/yum.repos.d/CentOS-Base.repo

更改内容如下

```
# CentOS-Base.repo 
# 
# This file uses a new mirrorlist system developed by Lance Davis for CentOS. 
# The mirror system uses the connecting IP address of the client and the 


# update status of each mirror to pick mirrors that are updated to and 
# geographically close to the client. You should use this for CentOS updates 
# unless you are manually picking other mirrors. 
# 
# If the mirrorlist= does not work for you, as a fall back you can try the 
# remarked out baseurl= line instead. 
# 
# 

[base] 
name=CentOS-$releasever - Base 
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os 
#baseurl=http://mirror.centos.org/centos/$releasever/os/$basearch/ 
baseurl=http://mirrors.163.com/centos/$releasever/os/$basearch/ 
gpgcheck=1 
gpgkey=http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-5 

#released updates 
[updates] 
name=CentOS-$releasever - Updates 
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates 
#baseurl=http://mirror.centos.org/centos/$releasever/updates/$basearch/ 
baseurl=http://mirrors.163.com/centos/$releasever/updates/$basearch/ 
gpgcheck=1 
gpgkey=http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-5 

#packages used/produced in the build but not released 
[addons] 
name=CentOS-$releasever - Addons 
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=addons 
#baseurl=http://mirror.centos.org/centos/$releasever/addons/$basearch/ 
baseurl=http://mirrors.163.com/centos/$releasever/addons/$basearch/ 
gpgcheck=1 
gpgkey=http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-5 

#additional packages that may be useful 
[extras] 
name=CentOS-$releasever - Extras 
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras 
#baseurl=http://mirror.centos.org/centos/$releasever/extras/$basearch/ 
baseurl=http://mirrors.163.com/centos/$releasever/extras/$basearch/ 
gpgcheck=1 
gpgkey=http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-5 

#additional packages that extend functionality of existing packages 
[centosplus] 
name=CentOS-$releasever - Plus 
#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=centosplus 
#baseurl=http://mirror.centos.org/centos/$releasever/centosplus/$basearch/ 
baseurl=http://mirrors.163.com/centos/$releasever/centosplus/$basearch/ 
gpgcheck=1 
enabled=0 
gpgkey=http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-5
```
### 二、update yum

>  yum -y update

### 三、利用CentOS Linux系统自带的yum命令安装、升级所需的程序库

```
LANG=C 

yum -y install gcc gcc-c++ autoconf libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs e2fsprogs-devel krb5 krb5-devel libidn libidn-devel openssl openssl-devel openldap openldap-devel nss_ldap openldap-clients openldap-servers
```

### 四、安装php和mysql

>  yum -y install php mysql mysql-server mysql-devel php-mysql php-cgi php-mbstring php-gd php-fastcgi

### 五、安装nginx

由于centos没有默认的nginx软件包，需要启用REHL的附件包

> rpm -Uvh http://download.Fedora.RedHat.com/pub/epel/5/i386/epel-release-5-4.noarch.rpm 
>
> yum -y install nginx

设置开机启动

>  chkconfig nginx on

### 六、安装spawn-fcgi来运行php-cgi

>  yum install spawn-fcgi

### 七、下载spawn-fcgi 的启动脚本

> wget http://bash.cyberciti.biz/dl/419.sh.zip 
>
> unzip 419.sh.zip 
>
> mv 419.sh /etc/init.d/php_cgi 
>
> chmod +x /etc/init.d/php_cgi

启动php_cgi

> /etc/init.d/php_cgi start

查看进程

> netstat -tulpn | grep :9000

若出现如下代表一切正常

> tcp 0 0 127.0.0.1:9000 0.0.0.0:* LISTEN 4352/php-cgi

### 八、配置nginx(详细配置见nginx.conf详细说明)

```
location ~ .php$ { 
  root html; 
  fastcgi_pass 127.0.0.1:9000; 
  fastcgi_index index.php; 
  fastcgi_param SCRIPT_FILENAME /usr/share/nginx/html$fastcgi_script_name; 
  include fastcgi_params; 
}
```

### 九、查看phpinfo

编写脚本

```phpinfo();```

### 十、安装phpmyadmin

修改/var/lib/php/session的权限和nginx和php_cgi一致

> chown -R www.www /var/lib/php/session



参考资料:

http://www.cnblogs.com/shaohuixia/p/5469177.html

