---
layout: post
title: "Cordova开发笔记 - 调用系统功能"
date: 2017-03-24
tag: cordova
---

[TOC]

### 1.目录结构

![](/images/posts/cordova/10.jpg)

### 2.配置文件config.xml

记录了应用的一些信息

应用名称

```xml
	<name>测试应用</name>
```

应用描述

```xml
    <description>
        A sample Apache Cordova application that responds to the deviceready event.
    </description>
```

入口文件，对应www中的文件

```xml
	<content src="index.html" />
```

配置图标

```xml
    <platform name="android">
        <icon src="res/android/drawable-ldpi/ic_launcher.png" density="ldpi" />
        <icon src="res/android/drawable-mdpi/ic_launcher.png" density="mdpi" />
        <icon src="res/android/drawable-hdpi/ic_launcher.png" density="hdpi" />
        <icon src="res/android/drawable-xhdpi/ic_launcher.png" density="xhdpi" />
        <icon src="res/android/drawable-xxhdpi/ic_launcher.png" density="xxhdpi" />
        <icon src="res/android/drawable-xxxhdpi/ic_launcher.png" density="xxxhdpi" />
    </platform>
```

### 3.插件

[插件搜索页](http://cordova.axuer.com/plugins/)

其中plugins文件夹存放的是各种cordova插件

> 查看已安装的插件
>
> cordova plugin ls

安装插件的命令如下，比如安装一个调用设备照相机功能的插件:

> cordova plugin add cordova-plugin-camera

搜索插件

> cordova plugin search camera

插件也可以通过目录或者git仓库添加。



### 4.调用系统功能

在www/js/index.js中

```javascript
var app = {
    initialize: function() {
        // 初始化事件
        // 类似于 onload(js)、ready(jquery)
        // deviceready 当设备准备就绪的时候触发
        document.addEventListener('deviceready', this.onDeviceReady, false);
        // pause 将程序置于后台的时候触发
        document.addEventListener('pause', this.onPause, false);
        // resume 将应用程序返回到前景的时候触发
        document.addEventListener('resume', this.onResume, false);

        // 系统按钮
        document.addEventListener('backbutton', this.onBackButton, false);
        document.addEventListener('menubutton', this.onMenuButton, false);
        document.addEventListener('volumedownbutton', this.onVolumedownButton, false);
        document.addEventListener('volumeupbutton', this.onVolumeupButton, false);
        document.addEventListener("searchbutton", this.onSearchKeyDown, false);
        document.addEventListener("startcallbutton", this.onStartCallKeyDown, false);
        document.addEventListener("endcallbutton", this.onEndCallKeyDown, false);

        // 调用系统功能(插件支持)
        var camera = document.getElementById("camera");
        camera.addEventListener('click', this.onCamera, false);
    },
    onCamera: function() {
        navigator.camera.getPicture(function() {
            alert("camera ok");
        }, function cameraError(error) {
            console.debug(error);
        });
    },
    onDeviceReady: function() {
        alert("设备准备就绪");
    },
    onPause: function() {
        alert("程序置于后台");
    },
    onResume: function() {
        alert("程序返回到前景");
    },
    onBackButton: function() {
        alert("按下返回按钮");
    },
    onMenuButton: function() {
        alert("按下菜单按钮");
    },
    onVolumedownButton: function() {
        alert("降低声音");
    },
    onVolumeupButton: function() {
        alert("增加声音");
    },
    onSearchKeyDown: function() {
        alert("搜索按钮按下");
    },
    onStartCallKeyDown: function() {
        alert("通话按钮按下");
    },
    onEndCallKeyDown: function() {
        alert("挂断按钮按下");
    }
};

app.initialize();
```

生命周期:

deviceready、pause、resume

系统按钮:

backbutton、menubutton、volumedownbutton、volumeupbutton、searchbutton、startcallbutton、endcallbutton

添加事件:

```javascript
// '事件名', 事件处理函数, 是否事件捕捉
document.addEventListener('事件名', function, true || false);
```

app.initialize()

初始化应用程序