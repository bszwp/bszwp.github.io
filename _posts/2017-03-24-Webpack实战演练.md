---
layout: post
title: "Webpack实战演练"
date: 2017-03-24
description: "Webpack实战演练"
tag: 自动构建
---

[TOC]

### 一、环境搭建

#### 下载依赖

>- 全局依赖
>
>npm install -g webpack@1.12.3
>
>npm install -g webpack-dev-server@1.16.3
>
>
>
>- 局部依赖
>
>npm install --save-dev webpack@1.12.3
>
>npm install --save-dev webpack-dev-server@1.16.3
>
>npm install --save-dev html-webpack-plugin 
>
>
>
>- 类库和模块
>
>  npm install --save-dev director					路由
>
>  npm install --save-dev jquery					jquery
>
>  npm install --save-dev handlebars				模板引擎
>
>  npm install --save-dev stylus			
>
>
>
>- loaders
>
>npm install --save-dev handlebars-loader
>
>npm install --save-dev less-loader less style-loader css-loader	
>
>npm install --save-dev stylus-loader



### 二、模块开发

#### 目录结构

![](http://ondh71tpt.bkt.clouddn.com/img/posts/webpack/20.jpg)

index.html

```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>project</title>
    <!-- 通过html-webpack-plugin插件不需要手动指定打包生成的文件 -->
    <!-- <script src="dist/bundle.js"></script> -->
</head>
<body>

</body>
</html>
```

webpack.config.js

```javascript
var htmlWebpackPlugin = require("html-webpack-plugin");
var webpack = require("webpack");

module.exports = {
    entry: {
      	// 入口文件
        app: "./src/main.js",
        // 依赖的类库
        vendor: [
            "jquery",
            "director" //路由
        ]
    },
    output: {
     	// 将编译之后的文件放到的位置
        // path为指定生成文件的路径
        // dirname为当前路径
        path: __dirname + 'dist',
      	// 指定编译之后的文件名
        filename: "bundle.js"
    },
    module: {
        loaders: [{
      		// 编译less并引入样式
            test: /\.less/,
            loader: "style-loader!css-loader!less-loader"
        }, {
          	// 模板引擎
            test: /\.hbs/,
            loader: "handlebars-loader"
        }]
    },
    plugins: [
        // 通过html-webpack-plugin插件不需要手动指定打包生成的文件
        // <script src="dist/bundle.js"></script>
        new htmlWebpackPlugin({
            template: "./src/index.html"
        }),
        new webpack.optimize.CommonsChunkPlugin('vendor', 'vendor.js')
    ]
}
```

#### 使用jquery

main.js --- 使用jquery

```javascript
// 引入jquery
var $ = require("jquery");

document.write("hello webpack");
$('body').css({
    backgroundColor: '#f00'
});
```

输入http://localhost:8080/，效果如下

![](http://ondh71tpt.bkt.clouddn.com/img/posts/webpack/21.jpg)

#### 使用路由

目录结构

![](http://ondh71tpt.bkt.clouddn.com/img/posts/webpack/23.jpg)

index.html

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <div id="content"></div>

    <ul>
        <li><a href="#/home">home</a></li>
        <li><a href="#/mine">mine</a></li>
    </ul>
</body>
</html>
```

main.js

```javascript
// 路由
var routes = {
    // 访问的路由: 访问路由所触发的方法
    '/home': function() {
        console.log(1);
    },
    '/mine': function() {
        console.log(2);
    }
};

// 加载director之后执行回调函数
require(["director"], function(d) {
    var router = d.Router(routes);

    router.init();
});
```

效果如下

![](http://ondh71tpt.bkt.clouddn.com/img/posts/webpack/22.jpg)

#### 模板引擎

目录结构

![](http://ondh71tpt.bkt.clouddn.com/img/posts/webpack/24.jpg)

home.hds

```html
<div class="item">
    name : {{name}} <br/>
    addrerss : {{address}}
</div>
```

home.less

```less
.item{
    border-bottom: 1px solid #666;
    margin: 20px 0;
}
```

home.js

```javascript
var $ = require("jquery");

function render() {
    var tpl = require("./home.hbs");
    var data = {
        name: 'qzy',
        address: "ynnu"
    };
    var html = tpl(data);
    $("#content").html(html);
}

module.exports = {
    render: render
}
```

main.js

```javascript
// 路由
var routes = {
    // 访问的路由: 访问路由所触发的方法
    '/home': function() {
        var home = require("./component/home/home.js");
        home.render();
    },
    '/mine': function() {
        var mine = require("./component/mine/mine.js");
        mine.render();
    }
};

// 加载director之后执行回调函数
require(["director"], function(d) {
    var router = d.Router(routes);

    router.init();
});
```

效果如下

![](http://ondh71tpt.bkt.clouddn.com/img/posts/webpack/25.jpg)

![](http://ondh71tpt.bkt.clouddn.com/img/posts/webpack/26.jpg)





### 参考文章

[js模版引擎handlebars.js实用教程——目录](http://www.cnblogs.com/iyangyuan/p/3471227.html)

[Handlebars.js 模板引擎](http://www.ghostchina.com/introducing-the-handlebars-js-templating-engine/)

















